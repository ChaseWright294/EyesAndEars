import * as playback from '../playback';
export class CheapLocator {
    sequence;
    index = 0;
    constructor(sequence) {
        this.sequence = sequence;
    }
    setStartingIndex(index) {
        this.index = index;
        return this;
    }
    locate(time) {
        if (time.isLessThan(playback.Duration.zero())) {
            return 0;
        }
        if (time.isGreaterThan(this.sequence.getDuration())) {
            return this.sequence.getCount() - 1;
        }
        const previousIndex = this.index - 1;
        if (this.sequence.getEntry(previousIndex)?.durationRange.includes(time)) {
            return previousIndex;
        }
        const currentIndex = this.index;
        if (this.sequence.getEntry(currentIndex)?.durationRange.includes(time)) {
            return currentIndex;
        }
        const nextIndex = this.index + 1;
        if (this.sequence.getEntry(nextIndex)?.durationRange.includes(time)) {
            return nextIndex;
        }
        return null;
    }
}
